<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, user-scalable=no">
  <meta name="theme-color" content="#0a0a0f">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <title>Day by Day - Writing Prompts</title>

  <!-- Stylesheets -->
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="dashboard.css">

  <style>
    /* Prompts-specific styles */
    .prompts-container {
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
      padding-bottom: 100px;
      min-height: 100vh;
    }

    .prompts-header {
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--bg-card);
    }

    .prompts-header h1 {
      font-size: 1.75rem;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .prompts-header p {
      color: var(--text-secondary);
      font-size: 0.95rem;
    }

    /* Generate Prompt Card */
    .generate-card {
      background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
      border-radius: var(--radius-lg);
      padding: 24px;
      margin-bottom: 24px;
      text-align: center;
    }

    .generate-card h2 {
      font-size: 1.25rem;
      margin-bottom: 8px;
      color: #fff;
    }

    .generate-card p {
      color: rgba(255,255,255,0.8);
      margin-bottom: 16px;
      font-size: 0.9rem;
    }

    .generate-btn {
      background: rgba(255,255,255,0.2);
      color: #fff;
      border: 1px solid rgba(255,255,255,0.3);
      padding: 12px 24px;
      border-radius: var(--radius-md);
      font-size: 1rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .generate-btn:hover {
      background: rgba(255,255,255,0.3);
      transform: translateY(-1px);
    }

    .generated-prompt {
      margin-top: 20px;
      padding: 16px;
      background: rgba(0,0,0,0.2);
      border-radius: var(--radius-md);
      font-size: 1.1rem;
      line-height: 1.5;
      color: #fff;
      display: none;
    }

    .generated-prompt.show {
      display: block;
      animation: fadeIn 0.3s ease;
    }

    .use-prompt-btn {
      margin-top: 12px;
      background: #fff;
      color: var(--accent-primary);
      border: none;
      padding: 10px 20px;
      border-radius: var(--radius-md);
      font-size: 0.9rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .use-prompt-btn:hover {
      transform: scale(1.02);
    }

    /* Community Prompts Section */
    .community-section {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 20px;
      margin-bottom: 24px;
    }

    .community-section h2 {
      font-size: 1.1rem;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .community-section h2 svg {
      color: var(--accent-secondary);
    }

    .prompts-list {
      max-height: 300px;
      overflow-y: auto;
    }

    .prompt-item {
      padding: 12px 16px;
      background: var(--bg-secondary);
      border-radius: var(--radius-md);
      margin-bottom: 10px;
    }

    .prompt-item:last-child {
      margin-bottom: 0;
    }

    .prompt-text {
      color: var(--text-primary);
      font-size: 0.95rem;
      line-height: 1.4;
      margin-bottom: 6px;
    }

    .prompt-author {
      color: var(--text-secondary);
      font-size: 0.8rem;
    }

    .prompts-loading {
      text-align: center;
      color: var(--text-secondary);
      padding: 20px;
    }

    .no-prompts {
      text-align: center;
      color: var(--text-secondary);
      padding: 20px;
      font-style: italic;
    }

    /* Submit Prompt Section */
    .submit-section {
      background: var(--bg-card);
      border-radius: var(--radius-lg);
      padding: 20px;
    }

    .submit-section h2 {
      font-size: 1.1rem;
      margin-bottom: 8px;
    }

    .submit-section p {
      color: var(--text-secondary);
      font-size: 0.85rem;
      margin-bottom: 16px;
    }

    .submit-form {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }

    .submit-form input,
    .submit-form textarea {
      background: var(--bg-input);
      border: 1px solid var(--border-color);
      border-radius: var(--radius-md);
      padding: 12px 14px;
      color: var(--text-primary);
      font-size: 0.95rem;
    }

    .submit-form input::placeholder,
    .submit-form textarea::placeholder {
      color: var(--text-secondary);
    }

    .submit-form input:focus,
    .submit-form textarea:focus {
      outline: none;
      border-color: var(--accent-primary);
    }

    .submit-form textarea {
      min-height: 80px;
      resize: vertical;
    }

    .submit-form button {
      background: var(--accent-primary);
      color: #fff;
      border: none;
      padding: 12px 20px;
      border-radius: var(--radius-md);
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .submit-form button:hover {
      filter: brightness(1.1);
    }

    .submit-form button:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="prompts-container">
    <!-- Header -->
    <header class="prompts-header">
      <h1>Writing Prompts</h1>
      <p>Get inspired for your next journal entry</p>
    </header>

    <!-- Generate Prompt Card -->
    <div class="generate-card">
      <h2>Need Inspiration?</h2>
      <p>Let us suggest a prompt to get your thoughts flowing</p>
      <button class="generate-btn" onclick="generatePrompt()">
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M12 2L15.09 8.26L22 9.27L17 14.14L18.18 21.02L12 17.77L5.82 21.02L7 14.14L2 9.27L8.91 8.26L12 2Z"/>
        </svg>
        Generate Prompt
      </button>
      <div id="generatedPrompt" class="generated-prompt"></div>
    </div>

    <!-- Community Prompts -->
    <div class="community-section">
      <h2>
        <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/>
          <circle cx="9" cy="7" r="4"/>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87"/>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"/>
        </svg>
        Community Prompts
      </h2>
      <div id="promptsList" class="prompts-list">
        <div class="prompts-loading">Loading prompts...</div>
      </div>
    </div>

    <!-- Submit Your Prompt -->
    <div class="submit-section">
      <h2>Share Your Prompt</h2>
      <p>Have a great journaling prompt? Share it with the community!</p>
      <form class="submit-form" id="submitPromptForm" onsubmit="submitPrompt(event)">
        <input type="text" id="promptName" placeholder="Your name" required>
        <input type="email" id="promptEmail" placeholder="Your email" required>
        <textarea id="promptText" placeholder="Write your prompt here..." required></textarea>
        <button type="submit" id="submitBtn">Submit Prompt</button>
      </form>
    </div>
  </div>

  <!-- Bottom Navigation -->
  <nav class="bottom-nav">
    <a href="dashboard.html" class="nav-item">
      <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M19 21H5C4.45 21 4 20.55 4 20V11L12 3L20 11V20C20 20.55 19.55 21 19 21Z" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
        <path d="M9 21V14H15V21" stroke="currentColor" stroke-width="2" stroke-linejoin="round"/>
      </svg>
      <span>Home</span>
    </a>
    <a href="journalPrompts.html" class="nav-item active">
      <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M9.09 9C9.3251 8.33167 9.78915 7.76811 10.4 7.40913C11.0108 7.05016 11.7289 6.91894 12.4272 7.03871C13.1255 7.15849 13.7588 7.52152 14.2151 8.06353C14.6713 8.60553 14.9211 9.29152 14.92 10C14.92 12 11.92 13 11.92 13" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
        <circle cx="12" cy="17" r="1" fill="currentColor"/>
        <circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2"/>
      </svg>
      <span>Prompts</span>
    </a>
    <a href="connections.html" class="nav-item">
      <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M16 11C17.66 11 18.99 9.66 18.99 8C18.99 6.34 17.66 5 16 5C14.34 5 13 6.34 13 8C13 9.66 14.34 11 16 11Z" stroke="currentColor" stroke-width="2"/>
        <path d="M8 11C9.66 11 10.99 9.66 10.99 8C10.99 6.34 9.66 5 8 5C6.34 5 5 6.34 5 8C5 9.66 6.34 11 8 11Z" stroke="currentColor" stroke-width="2"/>
        <path d="M8 13C5.67 13 1 14.17 1 16.5V19H15V16.5C15 14.17 10.33 13 8 13Z" stroke="currentColor" stroke-width="2"/>
        <path d="M16 13C18.33 13 23 14.17 23 16.5V19H17V16.5" stroke="currentColor" stroke-width="2"/>
      </svg>
      <span>Connect</span>
    </a>
    <button class="nav-item" onclick="signOutUser()">
      <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <path d="M17 7L15.59 8.41L18.17 11H8V13H18.17L15.59 15.59L17 17L22 12L17 7Z" stroke="currentColor" stroke-width="0" fill="currentColor"/>
        <path d="M4 5H12V3H4C2.9 3 2 3.9 2 5V19C2 20.1 2.9 21 4 21H12V19H4V5Z" stroke="currentColor" stroke-width="0" fill="currentColor"/>
      </svg>
      <span>Logout</span>
    </button>
  </nav>

  <!-- Toast Container -->
  <div id="toastContainer"></div>

  <script>
    // Prompts data
    const localPrompts = [
      "What was your favorite memory from the past week?",
      "What is something you've been wanting to try but haven't had the chance to?",
      "What have you been procrastinating on lately?",
      "What are some ways you can practice self-care today?",
      "What is something you're grateful for right now?",
      "What is a challenge you've recently overcome?",
      "What are some small steps you can take today to work towards your goals?",
      "What is something that's been weighing on your mind lately?",
      "What is something you can do to show kindness to someone else today?",
      "What is a lesson you've learned recently?",
      "What is something that inspires you?",
      "What is something you're looking forward to?",
      "What is a place you've always wanted to visit?",
      "What is something that's been bringing you joy lately?",
      "Describe a moment today when you felt truly present.",
      "What would you tell your younger self?",
      "What's a fear you'd like to overcome?",
      "What does your ideal day look like?",
      "Who has influenced your life the most and how?",
      "What's something you've changed your mind about recently?"
    ];

    // Generate a random prompt
    function generatePrompt() {
      const randomPrompt = localPrompts[Math.floor(Math.random() * localPrompts.length)];
      const promptEl = document.getElementById('generatedPrompt');
      promptEl.innerHTML = `
        <div>"${randomPrompt}"</div>
        <button class="use-prompt-btn" onclick="usePrompt('${randomPrompt.replace(/'/g, "\\'")}')">
          Use This Prompt
        </button>
      `;
      promptEl.classList.add('show');
    }

    // Use the prompt - navigate to dashboard with prompt
    function usePrompt(prompt) {
      // Store prompt in sessionStorage and redirect to dashboard
      sessionStorage.setItem('selectedPrompt', prompt);
      window.location.href = 'dashboard.html';
    }

    // Fetch community prompts
    async function fetchPrompts() {
      const container = document.getElementById('promptsList');
      try {
        const response = await fetch('https://0a65j03yja.execute-api.us-west-2.amazonaws.com/prod/prompts');
        if (!response.ok) throw new Error('Failed to fetch');
        const prompts = await response.json();

        if (prompts.length === 0) {
          container.innerHTML = '<div class="no-prompts">No community prompts yet. Be the first to share!</div>';
          return;
        }

        container.innerHTML = prompts.map(p => `
          <div class="prompt-item">
            <div class="prompt-text">"${escapeHtml(p.prompt)}"</div>
            <div class="prompt-author">- ${escapeHtml(p.userName)}</div>
          </div>
        `).join('');
      } catch (error) {
        console.error('Error fetching prompts:', error);
        container.innerHTML = '<div class="no-prompts">Unable to load community prompts</div>';
      }
    }

    // Submit a new prompt
    async function submitPrompt(e) {
      e.preventDefault();
      const btn = document.getElementById('submitBtn');
      const name = document.getElementById('promptName').value.trim();
      const email = document.getElementById('promptEmail').value.trim();
      const prompt = document.getElementById('promptText').value.trim();

      if (!name || !email || !prompt) {
        showToast('Please fill in all fields', 'error');
        return;
      }

      btn.disabled = true;
      btn.textContent = 'Submitting...';

      try {
        const response = await fetch('https://0a65j03yja.execute-api.us-west-2.amazonaws.com/prod/addprompt', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({
            userId: Date.now().toString(),
            prompt: prompt,
            userName: name,
            userEmail: email
          })
        });

        if (!response.ok) throw new Error('Failed to submit');

        showToast('Thank you for sharing your prompt!', 'success');
        document.getElementById('submitPromptForm').reset();
        fetchPrompts(); // Refresh the list
      } catch (error) {
        console.error('Error submitting prompt:', error);
        showToast('Failed to submit prompt. Please try again.', 'error');
      } finally {
        btn.disabled = false;
        btn.textContent = 'Submit Prompt';
      }
    }

    // Helper functions
    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    function showToast(message, type = 'info') {
      const container = document.getElementById('toastContainer');
      const toast = document.createElement('div');
      toast.className = `toast ${type}`;
      toast.textContent = message;
      container.appendChild(toast);
      setTimeout(() => toast.remove(), 3000);
    }

    function signOutUser() {
      // Clear local storage and redirect
      localStorage.clear();
      sessionStorage.clear();
      window.location.href = 'index.html';
    }

    // Initialize
    document.addEventListener('DOMContentLoaded', fetchPrompts);
  </script>
</body>
</html>
